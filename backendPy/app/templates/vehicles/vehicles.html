{% extends "main.html" %}
{% block content %}
    <h2>Vehicles List</h2>
    <table>
        <thead>
            <tr>
                <th>Year</th>
                <th>Make</th>
                <th>Model</th>
                <th>VIN</th>
                {% if user.role == 'owner' or user.role == 'locksmith' %}
                    <th>Actions</th>
                {% endif %}
            </tr>
        </thead>
        <tbody>
            {% for vehicle in vehicles %}
                <tr>
                    <td>{{ vehicle.year }}</td>
                    <td>{{ vehicle.make }}</td>
                    <td>{{ vehicle.model }}</td>
                    <td>{{ vehicle.vin }}</td>
                    {% if user.role == 'owner' %}
                        <td>
                            <a href="{{ url_for('vehicles.edit', vehicle_id=vehicle.id) }}">Edit</a>
                            <a href="{{ url_for('vehicles.delete', vehicle_id=vehicle.id) }}" onclick="return confirm('Are you sure?');">Delete</a>
                        </td>
                    {% elif user.role == 'locksmith' %}
                        <td>
                            {% if vehicle.key_required %}
                                <a href="{{ url_for('orders.create', vehicle_id=vehicle.id) }}">Create Key Order</a>
                            {% else %}
                                <p>Key not required</p>
                            {% endif %}
                        </td>
                    {% endif %}
                </tr>
            {% endfor %}
        </tbody>
    </table>
    {% if user.role == 'owner' %}
        <a href="{{ url_for('vehicles.add') }}" class="button">Add Vehicle</a>
    {% endif %}
{% endblock %}